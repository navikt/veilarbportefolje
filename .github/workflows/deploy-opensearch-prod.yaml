name: Deploy OpenSearch-instans til Dev/Prod
on:
  workflow_dispatch:
    inputs:
      environment:
        description: "Hvilket milj√∏ skal det deployes til?"
        required: true
        type: choice
        options:
          - dev
          - prod
        default: "dev"

jobs:
  deploy-opensearch:
    name: Deploy opensearch
    permissions:
      id-token: write
    runs-on: ubuntu-latest
    steps:
      - name: Checkout 
        uses: actions/checkout@v4

      - name: Deploy OpenSearch to ${{ github.event.inputs.environment }}
        uses: nais/deploy/actions/deploy@v2
        env:
          CLUSTER: ${{ github.event.inputs.environment }}-gcp
          RESOURCE: ".nais/application/opensearch-${{ github.event.inputs.environment }}.yaml"
